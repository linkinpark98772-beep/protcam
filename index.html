<!doctype html>
<html lang="es" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plataforma de Cuidados de Salud - M√©rida, Yucat√°n</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"><!-- Firebase SDK v9 (Modular) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        .hidden { display: none !important; }
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
        }
        .rating-stars {
            color: #fbbf24;
        }
        .warning-stars {
            color: #ef4444;
        }
        .tab-active {
            border-bottom: 2px solid #3b82f6;
            color: #3b82f6;
        }
        .admin-tab-content {
            min-height: 500px;
        }
        .admin-tab-btn {
            transition: all 0.2s;
        }
        .admin-tab-btn:hover {
            color: #374151;
        }
        .admin-metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .admin-chart-placeholder {
            background: linear-gradient(45deg, #f3f4f6, #e5e7eb);
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-gray-50"><!-- Header -->
  <header class="bg-white shadow-sm border-b">
   <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center py-4">
     <div>
      <h1 id="app-title" class="text-2xl font-bold text-gray-900">Plataforma de Cuidados de Salud</h1>
      <p id="city-name" class="text-sm text-gray-600">M√©rida, Yucat√°n</p>
     </div>
     <div id="auth-buttons" class="flex space-x-3"><button id="login-btn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"> <i class="fas fa-sign-in-alt mr-2"></i>Acceder / Registrarse </button> <button id="admin-btn" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors"> <i class="fas fa-user-shield mr-2"></i>Acceso Admin </button>
     </div>
     <div id="user-menu" class="hidden flex items-center space-x-3">
      <div class="flex items-center space-x-2"><span id="user-name" class="text-gray-700"></span> <span id="user-badge" class="hidden px-2 py-1 text-xs text-white rounded-full bg-green-600"> <i class="fas fa-check-circle mr-1"></i>Verificado </span>
      </div><button id="logout-btn" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors"> <i class="fas fa-sign-out-alt mr-2"></i>Salir </button>
     </div>
    </div>
   </div>
  </header><!-- Main Content -->
  <main id="mainContent" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><!-- Patient Dashboard -->
   <div id="patientDashboard" class="hidden space-y-6">
    <div class="bg-white rounded-lg shadow-sm p-6">
     <div class="flex justify-between items-center mb-6">
      <div>
       <h2 class="text-2xl font-bold text-gray-900">Panel del Paciente</h2>
       <p class="text-gray-600">Gestiona tus servicios de salud</p>
      </div>
      <div class="flex items-center space-x-4">
       <div id="patient-subscription-status" class="px-4 py-2 rounded-lg text-sm font-medium"></div><button id="upgrade-patient-subscription" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors"> <i class="fas fa-crown mr-2"></i>Mejorar Plan </button>
      </div>
     </div><!-- Patient Stats -->
     <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
      <div class="bg-blue-50 p-4 rounded-lg">
       <h3 class="font-semibold text-blue-900">Servicios Solicitados</h3>
       <p id="patient-total-requests" class="text-2xl font-bold text-blue-600">0</p>
      </div>
      <div class="bg-green-50 p-4 rounded-lg">
       <h3 class="font-semibold text-green-900">Servicios Completados</h3>
       <p id="patient-completed-services" class="text-2xl font-bold text-green-600">0</p>
      </div>
      <div class="bg-purple-50 p-4 rounded-lg">
       <h3 class="font-semibold text-purple-900">Solicitudes Restantes</h3>
       <p id="patient-remaining-requests" class="text-2xl font-bold text-purple-600">0</p>
      </div>
      <div class="bg-yellow-50 p-4 rounded-lg">
       <h3 class="font-semibold text-yellow-900">Gasto Total</h3>
       <p id="patient-total-spent" class="text-2xl font-bold text-yellow-600">$0</p>
      </div>
     </div><!-- Quick Actions -->
     <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"><button id="find-professional-btn" class="bg-blue-600 text-white p-4 rounded-lg hover:bg-blue-700 transition-colors text-left"> <i class="fas fa-search text-2xl mb-2"></i> <h3 class="font-semibold">Buscar Profesional</h3><p class="text-sm opacity-90">Encuentra el cuidado que necesitas</p></button> <button id="post-job-offer-btn" class="bg-green-600 text-white p-4 rounded-lg hover:bg-green-700 transition-colors text-left"> <i class="fas fa-bullhorn text-2xl mb-2"></i> <h3 class="font-semibold">Publicar Oferta</h3><p class="text-sm opacity-90">Que los profesionales te encuentren</p></button> <button id="view-favorites-btn" class="bg-purple-600 text-white p-4 rounded-lg hover:bg-purple-700 transition-colors text-left"> <i class="fas fa-heart text-2xl mb-2"></i> <h3 class="font-semibold">Mis Favoritos</h3><p class="text-sm opacity-90">Profesionales que m√°s te gustan</p></button>
     </div>
    </div><!-- Patient Tabs -->
    <div class="bg-white rounded-lg shadow-sm">
     <div class="border-b">
      <nav class="flex space-x-8 px-6"><button class="patient-tab-btn py-4 px-2 border-b-2 border-blue-500 text-blue-600 font-medium" data-tab="active-requests"> Solicitudes Activas </button> <button class="patient-tab-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="service-history"> Historial de Servicios </button> <button class="patient-tab-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="job-offers"> Mis Ofertas de Trabajo </button> <button class="patient-tab-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="reviews"> Mis Rese√±as </button>
      </nav>
     </div>
     <div class="p-6">
      <div id="patient-active-requests" class="patient-tab-content">
       <div id="patient-requests-list" class="space-y-4"></div>
      </div>
      <div id="patient-service-history" class="patient-tab-content hidden">
       <div id="patient-history-list" class="space-y-4"></div>
      </div>
      <div id="patient-job-offers" class="patient-tab-content hidden">
       <div id="patient-offers-list" class="space-y-4"></div>
      </div>
      <div id="patient-reviews" class="patient-tab-content hidden">
       <div id="patient-reviews-list" class="space-y-4"></div>
      </div>
     </div>
    </div>
   </div><!-- Professional Dashboard -->
   <div id="professionalDashboard" class="hidden space-y-6">
    <div class="bg-white rounded-lg shadow-sm p-6">
     <div class="flex justify-between items-center mb-6">
      <div>
       <h2 class="text-2xl font-bold text-gray-900">Panel del Profesional</h2>
       <p class="text-gray-600">Gestiona tu pr√°ctica profesional</p>
      </div>
      <div class="flex items-center space-x-4">
       <div id="professional-verification-status" class="px-4 py-2 rounded-lg text-sm font-medium"></div>
       <div id="professional-subscription-status" class="px-4 py-2 rounded-lg text-sm font-medium"></div><button id="upgrade-professional-subscription" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"> <i class="fas fa-crown mr-2"></i>Mejorar Plan </button>
      </div>
     </div><!-- Professional Stats -->
     <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
      <div class="bg-blue-50 p-4 rounded-lg">
       <h3 class="font-semibold text-blue-900">Solicitudes Recibidas</h3>
       <p id="professional-total-requests" class="text-2xl font-bold text-blue-600">0</p>
      </div>
      <div class="bg-green-50 p-4 rounded-lg">
       <h3 class="font-semibold text-green-900">Servicios Completados</h3>
       <p id="professional-completed-services" class="text-2xl font-bold text-green-600">0</p>
      </div>
      <div class="bg-yellow-50 p-4 rounded-lg">
       <h3 class="font-semibold text-yellow-900">Calificaci√≥n</h3>
       <p id="professional-rating" class="text-2xl font-bold text-yellow-600">0.0</p>
      </div>
      <div class="bg-purple-50 p-4 rounded-lg">
       <h3 class="font-semibold text-purple-900">Ingresos del Mes</h3>
       <p id="professional-monthly-earnings" class="text-2xl font-bold text-purple-600">$0</p>
      </div>
      <div class="bg-red-50 p-4 rounded-lg">
       <h3 class="font-semibold text-red-900">Solicitudes Restantes</h3>
       <p id="professional-remaining-requests" class="text-2xl font-bold text-red-600">0</p>
      </div>
     </div><!-- Quick Actions -->
     <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"><button id="update-profile-btn" class="bg-blue-600 text-white p-4 rounded-lg hover:bg-blue-700 transition-colors text-left"> <i class="fas fa-user-edit text-2xl mb-2"></i> <h3 class="font-semibold">Actualizar Perfil</h3><p class="text-sm opacity-90">Edita tu informaci√≥n profesional</p></button> <button id="set-availability-btn" class="bg-green-600 text-white p-4 rounded-lg hover:bg-green-700 transition-colors text-left"> <i class="fas fa-calendar-alt text-2xl mb-2"></i> <h3 class="font-semibold">Disponibilidad</h3><p class="text-sm opacity-90">Configura tus horarios</p></button> <button id="view-analytics-btn" class="bg-purple-600 text-white p-4 rounded-lg hover:bg-purple-700 transition-colors text-left"> <i class="fas fa-chart-line text-2xl mb-2"></i> <h3 class="font-semibold">Estad√≠sticas</h3><p class="text-sm opacity-90">Analiza tu rendimiento</p></button> <button id="browse-jobs-btn" class="bg-orange-600 text-white p-4 rounded-lg hover:bg-orange-700 transition-colors text-left"> <i class="fas fa-briefcase text-2xl mb-2"></i> <h3 class="font-semibold">Ofertas de Trabajo</h3><p class="text-sm opacity-90">Encuentra nuevas oportunidades</p></button>
     </div>
    </div><!-- Professional Tabs -->
    <div class="bg-white rounded-lg shadow-sm">
     <div class="border-b">
      <nav class="flex space-x-8 px-6"><button class="professional-tab-btn py-4 px-2 border-b-2 border-blue-500 text-blue-600 font-medium" data-tab="pending-requests"> Solicitudes Pendientes </button> <button class="professional-tab-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="confirmed-services"> Servicios Confirmados </button> <button class="professional-tab-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="service-history"> Historial Completo </button> <button class="professional-tab-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="reviews"> Rese√±as Recibidas </button> <button class="professional-tab-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="earnings"> Ingresos </button>
      </nav>
     </div>
     <div class="p-6">
      <div id="professional-pending-requests" class="professional-tab-content">
       <div id="professional-requests-list" class="space-y-4"></div>
      </div>
      <div id="professional-confirmed-services" class="professional-tab-content hidden">
       <div id="professional-confirmed-list" class="space-y-4"></div>
      </div>
      <div id="professional-service-history" class="professional-tab-content hidden">
       <div id="professional-history-list" class="space-y-4"></div>
      </div>
      <div id="professional-reviews" class="professional-tab-content hidden">
       <div id="professional-reviews-list" class="space-y-4"></div>
      </div>
      <div id="professional-earnings" class="professional-tab-content hidden">
       <div id="professional-earnings-content" class="space-y-4"></div>
      </div>
     </div>
    </div>
   </div><!-- Value Propositions Section -->
   <div id="valuePropositions" class="mb-12"><!-- Hero Section -->
    <div class="text-center mb-12">
     <h2 class="text-4xl font-bold text-gray-900 mb-4">La Plataforma de Salud M√°s Confiable de Yucat√°n</h2>
     <p class="text-xl text-gray-600 max-w-3xl mx-auto">Conectamos profesionales de la salud verificados con pacientes que necesitan cuidados de calidad, creando una comunidad de confianza y profesionalismo.</p>
    </div><!-- For Health Professionals -->
    <div class="bg-gradient-to-br from-blue-50 to-indigo-100 rounded-2xl p-8 mb-8">
     <div class="flex items-center mb-6">
      <div class="bg-blue-600 rounded-full p-3 mr-4"><i class="fas fa-user-md text-white text-2xl"></i>
      </div>
      <h3 class="text-3xl font-bold text-blue-900">¬øEres Profesional de la Salud?</h3>
     </div>
     <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <div>
       <h4 class="text-xl font-semibold text-blue-800 mb-4">üöÄ Impulsa tu Carrera Profesional</h4>
       <ul class="space-y-3 text-gray-700">
        <li class="flex items-start"><i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i> <span><strong>M√°s Pacientes, M√°s Ingresos:</strong> Accede a cientos de familias que buscan tus servicios profesionales</span></li>
        <li class="flex items-start"><i class="fas fa-shield-alt text-blue-500 mr-3 mt-1"></i> <span><strong>Verificaci√≥n Profesional:</strong> Tus documentos y experiencia son validados, generando confianza inmediata</span></li>
        <li class="flex items-start"><i class="fas fa-star text-yellow-500 mr-3 mt-1"></i> <span><strong>Reputaci√≥n Digital:</strong> Construye tu prestigio con calificaciones reales de pacientes satisfechos</span></li>
        <li class="flex items-start"><i class="fas fa-clock text-purple-500 mr-3 mt-1"></i> <span><strong>Flexibilidad Total:</strong> T√∫ decides cu√°ndo, d√≥nde y a qu√© precio ofrecer tus servicios</span></li>
       </ul>
      </div>
      <div>
       <h4 class="text-xl font-semibold text-blue-800 mb-4">üíº Beneficios Exclusivos</h4>
       <div class="space-y-4">
        <div class="bg-white rounded-lg p-4 shadow-sm">
         <div class="flex items-center mb-2"><i class="fas fa-crown text-yellow-500 mr-2"></i> <span class="font-semibold">Plan Premium</span>
         </div>
         <p class="text-sm text-gray-600">Aparece primero en b√∫squedas, m√°s solicitudes mensuales, sin comisiones</p>
        </div>
        <div class="bg-white rounded-lg p-4 shadow-sm">
         <div class="flex items-center mb-2"><i class="fas fa-handshake text-green-500 mr-2"></i> <span class="font-semibold">Pagos Directos</span>
         </div>
         <p class="text-sm text-gray-600">Recibe el 100% del pago directamente del paciente, sin comisiones</p>
        </div>
        <div class="bg-white rounded-lg p-4 shadow-sm">
         <div class="flex items-center mb-2"><i class="fas fa-chart-line text-blue-500 mr-2"></i> <span class="font-semibold">An√°lisis Profesional</span>
         </div>
         <p class="text-sm text-gray-600">Estad√≠sticas de tus servicios, calificaciones y crecimiento profesional</p>
        </div>
       </div>
      </div>
     </div>
     <div class="mt-8 text-center"><button onclick="showSpecialistModal()" class="bg-blue-600 text-white px-8 py-4 rounded-xl text-lg font-semibold hover:bg-blue-700 transition-colors shadow-lg"> <i class="fas fa-rocket mr-2"></i>Comenzar como Profesional </button>
      <p class="text-sm text-blue-700 mt-2">‚úÖ Prueba gratuita 30 d√≠as ‚Ä¢ ‚úÖ Sin comisiones ‚Ä¢ ‚úÖ Soporte 24/7</p>
     </div>
    </div><!-- For Patients -->
    <div class="bg-gradient-to-br from-green-50 to-emerald-100 rounded-2xl p-8 mb-8">
     <div class="flex items-center mb-6">
      <div class="bg-green-600 rounded-full p-3 mr-4"><i class="fas fa-heart text-white text-2xl"></i>
      </div>
      <h3 class="text-3xl font-bold text-green-900">¬øNecesitas Cuidados de Salud?</h3>
     </div>
     <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <div>
       <h4 class="text-xl font-semibold text-green-800 mb-4">üè• Atenci√≥n de Calidad Garantizada</h4>
       <ul class="space-y-3 text-gray-700">
        <li class="flex items-start"><i class="fas fa-user-check text-green-500 mr-3 mt-1"></i> <span><strong>Solo Profesionales Verificados:</strong> Todos tienen documentos profesionales y experiencia comprobada</span></li>
        <li class="flex items-start"><i class="fas fa-map-marker-alt text-red-500 mr-3 mt-1"></i> <span><strong>Atenci√≥n a Domicilio:</strong> Recibe cuidados profesionales en la comodidad de tu hogar</span></li>
        <li class="flex items-start"><i class="fas fa-phone-alt text-blue-500 mr-3 mt-1"></i> <span><strong>Contacto Directo:</strong> Habla directamente con el profesional antes de contratar</span></li>
        <li class="flex items-start"><i class="fas fa-dollar-sign text-green-500 mr-3 mt-1"></i> <span><strong>Precios Transparentes:</strong> Conoce el costo exacto antes de confirmar el servicio</span></li>
       </ul>
      </div>
      <div>
       <h4 class="text-xl font-semibold text-green-800 mb-4">üõ°Ô∏è Tu Seguridad es Nuestra Prioridad</h4>
       <div class="space-y-4">
        <div class="bg-white rounded-lg p-4 shadow-sm">
         <div class="flex items-center mb-2"><i class="fas fa-id-card text-blue-500 mr-2"></i> <span class="font-semibold">Identificaci√≥n Verificada</span>
         </div>
         <p class="text-sm text-gray-600">Cada profesional presenta documentos oficiales e identificaci√≥n v√°lida</p>
        </div>
        <div class="bg-white rounded-lg p-4 shadow-sm">
         <div class="flex items-center mb-2"><i class="fas fa-comments text-purple-500 mr-2"></i> <span class="font-semibold">Calificaciones Reales</span>
         </div>
         <p class="text-sm text-gray-600">Lee opiniones de otros pacientes y elige con confianza</p>
        </div>
        <div class="bg-white rounded-lg p-4 shadow-sm">
         <div class="flex items-center mb-2"><i class="fas fa-headset text-green-500 mr-2"></i> <span class="font-semibold">Soporte Inmediato</span>
         </div>
         <p class="text-sm text-gray-600">Equipo de atenci√≥n disponible para resolver cualquier situaci√≥n</p>
        </div>
       </div>
      </div>
     </div>
     <div class="mt-8 text-center"><button onclick="showPatientModal()" class="bg-green-600 text-white px-8 py-4 rounded-xl text-lg font-semibold hover:bg-green-700 transition-colors shadow-lg"> <i class="fas fa-search mr-2"></i>Encontrar Profesional Ahora </button>
      <p class="text-sm text-green-700 mt-2">‚úÖ Prueba gratuita 15 d√≠as ‚Ä¢ ‚úÖ Contacto directo ‚Ä¢ ‚úÖ Atenci√≥n inmediata</p>
     </div>
    </div><!-- Statistics -->
    <div class="bg-gradient-to-r from-purple-600 to-blue-600 rounded-2xl p-8 text-white text-center">
     <h3 class="text-2xl font-bold mb-6">N√∫meros que Hablan por S√≠ Solos</h3>
     <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
      <div>
       <div class="text-3xl font-bold mb-2">
        500+
       </div>
       <div class="text-sm opacity-90">
        Profesionales Verificados
       </div>
      </div>
      <div>
       <div class="text-3xl font-bold mb-2">
        2,000+
       </div>
       <div class="text-sm opacity-90">
        Servicios Completados
       </div>
      </div>
      <div>
       <div class="text-3xl font-bold mb-2">
        4.8‚òÖ
       </div>
       <div class="text-sm opacity-90">
        Calificaci√≥n Promedio
       </div>
      </div>
      <div>
       <div class="text-3xl font-bold mb-2">
        98%
       </div>
       <div class="text-sm opacity-90">
        Satisfacci√≥n del Cliente
       </div>
      </div>
     </div>
    </div>
   </div><!-- Subscription Plans Section -->
   <div id="subscriptionPlans" class="space-y-12"><!-- Professional Plans -->
    <div class="bg-gradient-to-br from-blue-50 to-indigo-100 rounded-2xl p-8">
     <div class="text-center mb-8">
      <div class="flex items-center justify-center mb-4">
       <div class="bg-blue-600 rounded-full p-3 mr-4"><i class="fas fa-user-md text-white text-2xl"></i>
       </div>
       <h2 class="text-3xl font-bold text-blue-900">Planes para Profesionales de Salud</h2>
      </div>
      <p class="text-xl text-blue-700 max-w-3xl mx-auto">Impulsa tu carrera profesional y conecta con m√°s pacientes</p>
     </div>
     <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"><!-- Trial Plan -->
      <div class="bg-white rounded-xl shadow-lg border-2 border-gray-200 p-6 relative">
       <div class="text-center mb-6">
        <h3 class="text-xl font-bold text-gray-900 mb-2">Prueba Gratuita</h3>
        <div class="text-3xl font-bold text-gray-600 mb-1">
         $0
        </div>
        <div class="text-sm text-gray-500">
         30 d√≠as gratis
        </div>
       </div>
       <ul class="space-y-3 mb-6">
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>8 solicitudes incluidas</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>Perfil b√°sico</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>Perfecto para probar</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>Soporte por email</span></li>
       </ul><button onclick="showPlanDetails('professional', 'trial')" class="w-full bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition-colors"> Ver Detalles </button>
      </div><!-- Basic Plan -->
      <div class="bg-white rounded-xl shadow-lg border-2 border-blue-200 p-6 relative">
       <div class="text-center mb-6">
        <h3 class="text-xl font-bold text-blue-900 mb-2">Plan B√°sico</h3>
        <div class="text-3xl font-bold text-blue-600 mb-1">
         $49
        </div>
        <div class="text-sm text-blue-500">
         por mes
        </div>
       </div>
       <ul class="space-y-3 mb-6">
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>8 solicitudes por mes</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>Ideal para medio tiempo</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>Perfil completo</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>Soporte prioritario</span></li>
       </ul><button onclick="showPlanDetails('professional', 'basic')" class="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-colors"> Ver Detalles </button>
      </div><!-- Pro Plan -->
      <div class="bg-white rounded-xl shadow-lg border-2 border-purple-200 p-6 relative">
       <div class="absolute -top-3 left-1/2 transform -translate-x-1/2"><span class="bg-purple-600 text-white px-4 py-1 rounded-full text-xs font-semibold">POPULAR</span>
       </div>
       <div class="text-center mb-6">
        <h3 class="text-xl font-bold text-purple-900 mb-2">Plan Pro</h3>
        <div class="text-3xl font-bold text-purple-600 mb-1">
         $199
        </div>
        <div class="text-sm text-purple-500">
         por mes
        </div>
       </div>
       <ul class="space-y-3 mb-6">
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>15 solicitudes por mes</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>Para especialistas activos</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>Perfil destacado</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>Badge PRO</span></li>
       </ul><button onclick="showPlanDetails('professional', 'pro')" class="w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition-colors"> Ver Detalles </button>
      </div><!-- Premium Plan -->
      <div class="bg-gradient-to-br from-yellow-400 to-orange-500 rounded-xl shadow-lg border-2 border-yellow-300 p-6 relative text-white">
       <div class="absolute -top-3 left-1/2 transform -translate-x-1/2"><span class="bg-yellow-600 text-white px-4 py-1 rounded-full text-xs font-semibold">PREMIUM</span>
       </div>
       <div class="text-center mb-6">
        <h3 class="text-xl font-bold mb-2">Plan Premium</h3>
        <div class="text-3xl font-bold mb-1">
         $399
        </div>
        <div class="text-sm opacity-90">
         por mes
        </div>
       </div>
       <ul class="space-y-3 mb-6">
        <li class="flex items-center text-sm"><i class="fas fa-crown text-yellow-200 mr-2"></i> <span>25 solicitudes por mes</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-crown text-yellow-200 mr-2"></i> <span>Tiempo completo</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-crown text-yellow-200 mr-2"></i> <span>Aparece primero</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-crown text-yellow-200 mr-2"></i> <span>Soporte VIP</span></li>
       </ul><button onclick="showPlanDetails('professional', 'premium')" class="w-full bg-white text-orange-600 py-3 rounded-lg hover:bg-gray-100 transition-colors font-semibold"> Ver Detalles </button>
      </div>
     </div>
    </div><!-- Patient Plans -->
    <div class="bg-gradient-to-br from-green-50 to-emerald-100 rounded-2xl p-8">
     <div class="text-center mb-8">
      <div class="flex items-center justify-center mb-4">
       <div class="bg-green-600 rounded-full p-3 mr-4"><i class="fas fa-heart text-white text-2xl"></i>
       </div>
       <h2 class="text-3xl font-bold text-green-900">Planes para Pacientes</h2>
      </div>
      <p class="text-xl text-green-700 max-w-3xl mx-auto">Accede a los mejores profesionales de salud cuando los necesites</p>
     </div>
     <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto"><!-- Trial Plan -->
      <div class="bg-white rounded-xl shadow-lg border-2 border-gray-200 p-6">
       <div class="text-center mb-6">
        <h3 class="text-xl font-bold text-gray-900 mb-2">Prueba Gratuita</h3>
        <div class="text-3xl font-bold text-gray-600 mb-1">
         $0
        </div>
        <div class="text-sm text-gray-500">
         15 d√≠as gratis
        </div>
       </div>
       <ul class="space-y-3 mb-6">
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>5 contactos incluidos</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>B√∫squeda b√°sica</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>Perfecto para probar</span></li>
       </ul><button onclick="showPlanDetails('patient', 'trial')" class="w-full bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition-colors"> Ver Detalles </button>
      </div><!-- Basic Plan -->
      <div class="bg-white rounded-xl shadow-lg border-2 border-green-200 p-6">
       <div class="text-center mb-6">
        <h3 class="text-xl font-bold text-green-900 mb-2">Plan B√°sico</h3>
        <div class="text-3xl font-bold text-green-600 mb-1">
         $29
        </div>
        <div class="text-sm text-green-500">
         por mes
        </div>
       </div>
       <ul class="space-y-3 mb-6">
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>5 contactos por mes</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>Necesidades ocasionales</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>B√∫squeda completa</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-check text-green-500 mr-2"></i> <span>Contacto directo</span></li>
       </ul><button onclick="showPlanDetails('patient', 'basic')" class="w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-colors"> Ver Detalles </button>
      </div><!-- Premium Plan -->
      <div class="bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl shadow-lg border-2 border-green-400 p-6 text-white relative">
       <div class="absolute -top-3 left-1/2 transform -translate-x-1/2"><span class="bg-green-700 text-white px-4 py-1 rounded-full text-xs font-semibold">RECOMENDADO</span>
       </div>
       <div class="text-center mb-6">
        <h3 class="text-xl font-bold mb-2">Plan Premium</h3>
        <div class="text-3xl font-bold mb-1">
         $149
        </div>
        <div class="text-sm opacity-90">
         por mes
        </div>
       </div>
       <ul class="space-y-3 mb-6">
        <li class="flex items-center text-sm"><i class="fas fa-star text-yellow-300 mr-2"></i> <span>15 contactos por mes</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-star text-yellow-300 mr-2"></i> <span>Para familias activas</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-star text-yellow-300 mr-2"></i> <span>Publicar ofertas trabajo</span></li>
        <li class="flex items-center text-sm"><i class="fas fa-star text-yellow-300 mr-2"></i> <span>Soporte prioritario</span></li>
       </ul><button onclick="showPlanDetails('patient', 'premium')" class="w-full bg-white text-green-600 py-3 rounded-lg hover:bg-gray-100 transition-colors font-semibold"> Ver Detalles </button>
      </div>
     </div>
    </div><!-- Comparison Section -->
    <div class="bg-white rounded-2xl shadow-lg p-8">
     <div class="text-center mb-8">
      <h2 class="text-3xl font-bold text-gray-900 mb-4">¬øPor qu√© elegir nuestros planes?</h2>
      <p class="text-xl text-gray-600">Beneficios exclusivos para cada tipo de usuario</p>
     </div>
     <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <div class="bg-blue-50 rounded-xl p-6">
       <h3 class="text-xl font-bold text-blue-900 mb-4"><i class="fas fa-user-md mr-2"></i>Beneficios para Profesionales</h3>
       <ul class="space-y-3">
        <li class="flex items-start"><i class="fas fa-check-circle text-blue-600 mr-3 mt-1"></i> <span class="text-gray-700"><strong>Sin comisiones:</strong> Recibe el 100% del pago directamente</span></li>
        <li class="flex items-start"><i class="fas fa-check-circle text-blue-600 mr-3 mt-1"></i> <span class="text-gray-700"><strong>Verificaci√≥n profesional:</strong> Badge de confianza para m√°s clientes</span></li>
        <li class="flex items-start"><i class="fas fa-check-circle text-blue-600 mr-3 mt-1"></i> <span class="text-gray-700"><strong>Flexibilidad total:</strong> T√∫ decides horarios y precios</span></li>
        <li class="flex items-start"><i class="fas fa-check-circle text-blue-600 mr-3 mt-1"></i> <span class="text-gray-700"><strong>Estad√≠sticas avanzadas:</strong> Analiza tu rendimiento</span></li>
       </ul>
      </div>
      <div class="bg-green-50 rounded-xl p-6">
       <h3 class="text-xl font-bold text-green-900 mb-4"><i class="fas fa-heart mr-2"></i>Beneficios para Pacientes</h3>
       <ul class="space-y-3">
        <li class="flex items-start"><i class="fas fa-check-circle text-green-600 mr-3 mt-1"></i> <span class="text-gray-700"><strong>Solo profesionales verificados:</strong> M√°xima seguridad</span></li>
        <li class="flex items-start"><i class="fas fa-check-circle text-green-600 mr-3 mt-1"></i> <span class="text-gray-700"><strong>Atenci√≥n a domicilio:</strong> Comodidad en tu hogar</span></li>
        <li class="flex items-start"><i class="fas fa-check-circle text-green-600 mr-3 mt-1"></i> <span class="text-gray-700"><strong>Precios transparentes:</strong> Sin sorpresas en el costo</span></li>
        <li class="flex items-start"><i class="fas fa-check-circle text-green-600 mr-3 mt-1"></i> <span class="text-gray-700"><strong>Soporte 24/7:</strong> Ayuda cuando la necesites</span></li>
       </ul>
      </div>
     </div>
    </div>
   </div><!-- Hidden Nurses List (for logged in users) -->
   <div id="nursesList" class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
  </main><!-- Admin Panel -->
  <div id="adminPanel" class="hidden space-y-6"><!-- Stats -->
   <div class="bg-white rounded-lg shadow-sm p-6">
    <div class="flex justify-between items-center mb-4">
     <h2 class="text-xl font-bold text-gray-900">Panel de Administraci√≥n</h2><button id="admin-logout-btn" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors"> <i class="fas fa-sign-out-alt mr-2"></i>Cerrar Sesi√≥n Admin </button>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
     <div class="bg-blue-50 p-4 rounded-lg">
      <h3 class="font-semibold text-blue-900">Total Profesionales</h3>
      <p id="total-nurses" class="text-2xl font-bold text-blue-600">0</p>
     </div>
     <div class="bg-green-50 p-4 rounded-lg">
      <h3 class="font-semibold text-green-900">Verificados</h3>
      <p id="total-verified" class="text-2xl font-bold text-green-600">0</p>
     </div>
     <div class="bg-yellow-50 p-4 rounded-lg">
      <h3 class="font-semibold text-yellow-900">Pendientes</h3>
      <p id="total-pending" class="text-2xl font-bold text-yellow-600">0</p>
     </div>
     <div class="bg-red-50 p-4 rounded-lg">
      <h3 class="font-semibold text-red-900">Rechazados</h3>
      <p id="total-rejected" class="text-2xl font-bold text-red-600">0</p>
     </div>
     <div class="bg-purple-50 p-4 rounded-lg">
      <h3 class="font-semibold text-purple-900">Suscripciones</h3>
      <p id="total-subscriptions" class="text-2xl font-bold text-purple-600">0</p>
     </div>
    </div>
   </div><!-- Subscription Management -->
   <div class="bg-white rounded-lg shadow-sm p-6">
    <div class="flex justify-between items-center mb-4">
     <h3 class="text-lg font-bold text-gray-900">Gesti√≥n de Suscripciones</h3><button id="gift-subscription-btn" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors"> <i class="fas fa-gift mr-2"></i>Regalar Suscripci√≥n </button>
    </div>
    <div id="subscriptionManagement" class="space-y-4"></div>
   </div><!-- Pending Verifications -->
   <div class="bg-white rounded-lg shadow-sm p-6">
    <h3 class="text-lg font-bold text-gray-900 mb-4">Solicitudes de Verificaci√≥n Pendientes</h3>
    <div id="pendingVerifications" class="space-y-4"></div>
   </div><!-- User Management -->
   <div class="bg-white rounded-lg shadow-sm p-6">
    <div class="flex justify-between items-center mb-6">
     <h3 class="text-lg font-bold text-gray-900">Usuarios Registrados</h3>
     <div class="flex space-x-2"><button id="filter-professionals" class="px-4 py-2 bg-blue-100 text-blue-800 rounded-lg hover:bg-blue-200 transition-colors"> <i class="fas fa-user-md mr-2"></i>Profesionales </button> <button id="filter-patients" class="px-4 py-2 bg-green-100 text-green-800 rounded-lg hover:bg-green-200 transition-colors"> <i class="fas fa-heart mr-2"></i>Pacientes </button> <button id="filter-all-users" class="px-4 py-2 bg-gray-100 text-gray-800 rounded-lg hover:bg-gray-200 transition-colors"> <i class="fas fa-users mr-2"></i>Todos </button>
     </div>
    </div>
    <div id="registeredUsers" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
   </div>
  </div>
  <script type="module">
        // Configuraci√≥n de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyB0fmLJ4PL_qtawelrXNLQzRThlAplS9qM",
            authDomain: "plataforma-salud-merida.firebaseapp.com",
            projectId: "plataforma-salud-merida",
            storageBucket: "plataforma-salud-merida.firebasestorage.app",
            messagingSenderId: "107718255686",
            appId: "1:107718255686:web:f8519f52cf6fb2daaed647",
            measurementId: "G-09Q9EC6NVK"
        };

        // Inicializar Firebase
        let app, db, auth;
        try {
            app = firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            auth = firebase.auth();
            console.log('‚úÖ Firebase inicializado correctamente');
        } catch (error) {
            console.error('‚ùå Error inicializando Firebase:', error);
        }

        // Variables globales
        let currentUser = null;
        let currentData = [];
        let filteredNurses = [];

        // Configuraci√≥n de suscripciones - Sistema Realista
        const subscriptionPlans = {
            professional: {
                trial: { name: 'Prueba Gratuita', price: 0, duration: 30, requests: 8, features: ['Perfil b√°sico', '8 solicitudes incluidas', 'Perfecto para probar la plataforma', 'Soporte por email'] },
                basic: { name: 'Plan B√°sico', price: 49, duration: 30, requests: 8, features: ['8 solicitudes por mes (2 por semana)', 'Ideal para trabajo de medio tiempo', 'Perfil completo', 'Soporte prioritario'] },
                pro: { name: 'Plan Pro', price: 199, duration: 30, requests: 15, features: ['15 solicitudes por mes (3-4 por semana)', 'Para especialistas activos', 'Perfil destacado', 'Estad√≠sticas avanzadas', 'Badge PRO'] },
                premium: { name: 'Plan Premium', price: 399, duration: 30, requests: 25, features: ['25 solicitudes por mes (6 por semana)', 'Para especialistas de tiempo completo', 'Perfil premium', 'Aparece primero', 'An√°lisis completo', 'Soporte VIP'] }
            },
            patient: {
                trial: { name: 'Prueba Gratuita', price: 0, duration: 15, requests: 5, features: ['5 contactos incluidos', 'B√∫squeda b√°sica', 'Perfecto para probar'] },
                basic: { name: 'Plan B√°sico', price: 29, duration: 30, requests: 5, features: ['5 contactos por mes', 'Para necesidades ocasionales', 'B√∫squeda completa', 'Contacto directo'] },
                premium: { name: 'Plan Premium', price: 149, duration: 30, requests: 15, features: ['15 contactos por mes', 'Para familias con necesidades frecuentes', 'Acceso completo', 'Publicar ofertas de trabajo', 'Soporte prioritario'] }
            }
        };

        // Servicio Firebase mejorado
        const FirebaseService = {
            onDataChanged: null,
            unsubscribe: null,
            isConnected: false,

            // Inicializar listener de datos
            init(callback) {
                try {
                    this.onDataChanged = callback;
                    
                    // Escuchar cambios en tiempo real
                    this.unsubscribe = db.collection('platform_data').onSnapshot((snapshot) => {
                        const data = [];
                        snapshot.forEach((doc) => {
                            data.push({ id: doc.id, ...doc.data() });
                        });
                        
                        this.isConnected = true;
                        console.log('üî• Firebase data updated:', data.length, 'documents');
                        this.onDataChanged(data);
                    }, (error) => {
                        console.error('‚ùå Error listening to data changes:', error);
                        this.isConnected = false;
                        
                        // Intentar reconectar despu√©s de un error
                        setTimeout(() => {
                            console.log('üîÑ Attempting to reconnect to Firebase...');
                            this.init(callback);
                        }, 5000);
                    });

                    return { isOk: true };
                } catch (error) {
                    console.error('‚ùå Error initializing Firebase listener:', error);
                    this.isConnected = false;
                    return { isOk: false, error };
                }
            },

            // Crear documento
            async create(data) {
                try {
                    // Generar ID personalizado si no existe
                    const docId = data.id || data.customId || db.collection('platform_data').doc().id;
                    
                    const docData = {
                        ...data,
                        id: docId, // Asegurar que el ID est√© en los datos
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    };
                    
                    // Usar set en lugar de add para controlar el ID
                    await db.collection('platform_data').doc(docId).set(docData);
                    console.log('‚úÖ Document created with ID:', docId);
                    return { isOk: true, id: docId };
                } catch (error) {
                    console.error('‚ùå Error creating document:', error);
                    return { isOk: false, error };
                }
            },

            // Actualizar documento
            async update(data) {
                try {
                    if (!data.id) {
                        throw new Error('Document ID is required for update');
                    }
                    
                    const docRef = db.collection('platform_data').doc(data.id);
                    const updateData = { ...data };
                    updateData.updatedAt = firebase.firestore.FieldValue.serverTimestamp();
                    
                    // Usar set con merge para actualizar
                    await docRef.set(updateData, { merge: true });
                    console.log('‚úÖ Document updated:', data.id);
                    return { isOk: true };
                } catch (error) {
                    console.error('‚ùå Error updating document:', error);
                    return { isOk: false, error };
                }
            },

            // Eliminar documento
            async delete(data) {
                try {
                    if (!data.id) {
                        throw new Error('Document ID is required for delete');
                    }
                    
                    await db.collection('platform_data').doc(data.id).delete();
                    console.log('‚úÖ Document deleted:', data.id);
                    return { isOk: true };
                } catch (error) {
                    console.error('‚ùå Error deleting document:', error);
                    return { isOk: false, error };
                }
            },

            // Obtener todos los documentos
            async getAll() {
                try {
                    const snapshot = await db.collection('platform_data').get();
                    const data = [];
                    snapshot.forEach((doc) => {
                        data.push({ id: doc.id, ...doc.data() });
                    });
                    return { isOk: true, data };
                } catch (error) {
                    console.error('‚ùå Error getting documents:', error);
                    return { isOk: false, error };
                }
            },

            // Limpiar listeners
            cleanup() {
                if (this.unsubscribe) {
                    this.unsubscribe();
                    this.unsubscribe = null;
                }
                this.isConnected = false;
            }
        };

        // Inicializar aplicaci√≥n con Firebase
        async function initializeApp() {
            try {
                // Verificar que Firebase est√© inicializado
                if (!db) {
                    throw new Error('Firebase no est√° inicializado correctamente');
                }

                // Mostrar indicador de carga inicial
                const container = document.getElementById('nursesList');
                if (container) {
                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <i class="fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"></i>
                            <h3 class="text-lg font-semibold text-gray-600 mb-2">Conectando con Firebase...</h3>
                            <p class="text-gray-500">Inicializando base de datos</p>
                        </div>
                    `;
                }

                // Inicializar Firebase listener
                const result = FirebaseService.init((data) => {
                    currentData = data;
                    updateUI();
                });

                if (!result.isOk) {
                    throw new Error('Error initializing Firebase listener');
                }

                console.log('üöÄ Aplicaci√≥n inicializada correctamente');
                
                // Esperar un momento para que se carguen los datos
                setTimeout(() => {
                    if (currentData.length === 0) {
                        console.log('üìù No hay datos, creando datos de ejemplo...');
                        createSampleUsers();
                    }
                }, 3000);

            } catch (error) {
                console.error('üí• Error cr√≠tico inicializando aplicaci√≥n:', error);
                const container = document.getElementById('nursesList');
                if (container) {
                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <i class="fas fa-exclamation-triangle text-4xl text-red-500 mb-4"></i>
                            <h3 class="text-lg font-semibold text-red-600 mb-2">Error de Conexi√≥n</h3>
                            <p class="text-gray-500 mb-4">No se pudo conectar con Firebase</p>
                            <button onclick="location.reload()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                                Recargar P√°gina
                            </button>
                        </div>
                    `;
                }
            }
        }

        // Actualizar UI
        function updateUI() {
            updateNursesList();
            updateAdminStats();
            updatePendingVerifications();
            updateRegisteredUsers('all');
            updateSubscriptionManagement();
            
            // Si no hay datos, mostrar mensaje de carga
            if (currentData.length === 0) {
                const container = document.getElementById('nursesList');
                if (container) {
                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <i class="fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"></i>
                            <h3 class="text-lg font-semibold text-gray-600 mb-2">Cargando profesionales...</h3>
                            <p class="text-gray-500">Por favor espera mientras cargamos los datos</p>
                        </div>
                    `;
                }
            }
        }

        // Actualizar interfaz de usuario (CORREGIDA)
        function updateUserInterface() {
            // Obtener elementos de forma segura
            const authButtons = document.getElementById('auth-buttons');
            const userMenu = document.getElementById('user-menu');
            const postJobBtn = document.getElementById('post-job-btn');
            const mainContent = document.getElementById('mainContent');
            const patientDashboard = document.getElementById('patientDashboard');
            const professionalDashboard = document.getElementById('professionalDashboard');
            const adminPanel = document.getElementById('adminPanel');
            const valuePropositions = document.getElementById('valuePropositions');
            const subscriptionPlans = document.getElementById('subscriptionPlans');
            const nursesList = document.getElementById('nursesList');
            const userName = document.getElementById('user-name');
            const userBadge = document.getElementById('user-badge');

            // Verificar que los elementos cr√≠ticos existen
            if (!authButtons || !userMenu || !mainContent) {
                console.error('‚ùå Elementos cr√≠ticos del DOM no encontrados');
                return;
            }

            if (currentUser) {
                // Mostrar men√∫ de usuario
                authButtons.classList.add('hidden');
                userMenu.classList.remove('hidden');
                
                // Actualizar nombre de usuario
                if (userName) {
                    userName.textContent = currentUser.name;
                }
                
                // Mostrar badge de verificaci√≥n para profesionales
                if (userBadge) {
                    if (currentUser.type === 'nurse' && currentUser.verified) {
                        userBadge.classList.remove('hidden');
                    } else {
                        userBadge.classList.add('hidden');
                    }
                }

                // Ocultar contenido principal y mostrar panel espec√≠fico
                if (valuePropositions) valuePropositions.classList.add('hidden');
                if (subscriptionPlans) subscriptionPlans.classList.add('hidden');
                if (nursesList) nursesList.classList.add('hidden');
                if (adminPanel) adminPanel.classList.add('hidden');
                
                // Mostrar dashboard correspondiente
                if (currentUser.type === 'patient') {
                    if (patientDashboard) {
                        patientDashboard.classList.remove('hidden');
                        updatePatientDashboard();
                    }
                    if (professionalDashboard) {
                        professionalDashboard.classList.add('hidden');
                    }
                } else if (currentUser.type === 'nurse') {
                    if (professionalDashboard) {
                        professionalDashboard.classList.remove('hidden');
                        updateProfessionalDashboard();
                    }
                    if (patientDashboard) {
                        patientDashboard.classList.add('hidden');
                    }
                }

                // Mostrar bot√≥n de publicar trabajo solo para pacientes premium
                if (postJobBtn) {
                    if (currentUser.type === 'patient' && currentUser.subscription?.plan === 'premium') {
                        postJobBtn.classList.remove('hidden');
                    } else {
                        postJobBtn.classList.add('hidden');
                    }
                }
            } else {
                // Mostrar botones de autenticaci√≥n
                authButtons.classList.remove('hidden');
                userMenu.classList.add('hidden');
                if (postJobBtn) postJobBtn.classList.add('hidden');
                
                // Mostrar contenido principal con suscripciones
                if (valuePropositions) valuePropositions.classList.remove('hidden');
                if (subscriptionPlans) subscriptionPlans.classList.remove('hidden');
                if (nursesList) nursesList.classList.add('hidden');
                if (patientDashboard) patientDashboard.classList.add('hidden');
                if (professionalDashboard) professionalDashboard.classList.add('hidden');
                if (adminPanel) adminPanel.classList.add('hidden');
            }
        }

        // Funci√≥n para mostrar modal de especialista
        window.showSpecialistModal = function() {
            showModal('Registro de Profesional de Salud', `
                <form id="specialist-form" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nombre Completo</label>
                            <input type="text" name="name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <input type="email" name="email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Tel√©fono</label>
                            <input type="tel" name="phone" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Especialidad</label>
                            <select name="specialty" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Seleccionar √°rea de especialidad</option>
                                <option value="enfermeria_general">Enfermer√≠a General</option>
                                <option value="medicina_general">Medicina General</option>
                                <option value="fisioterapia">Fisioterapia y Rehabilitaci√≥n</option>
                                <option value="psicologia">Psicolog√≠a y Salud Mental</option>
                                <option value="nutricion">Nutrici√≥n y Diet√©tica</option>
                                <option value="cuidador">Cuidador Profesional</option>
                                <option value="cuidados_geriatricos">Geriatr√≠a y Gerontolog√≠a</option>
                                <option value="cuidados_pediatricos">Pediatr√≠a y Neonatolog√≠a</option>
                                <option value="terapia_ocupacional">Terapia Ocupacional</option>
                                <option value="cuidados_paliativos">Cuidados Paliativos</option>
                                <option value="trabajo_social">Trabajo Social en Salud</option>
                                <option value="cuidados_intensivos">Cuidados Intensivos</option>
                                <option value="medicina_alternativa">Medicina Alternativa</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">A√±os de Experiencia</label>
                            <input type="number" name="experience" min="0" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Precio por Hora (MXN)</label>
                            <input type="number" name="hourlyRate" min="100" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Descripci√≥n Profesional</label>
                        <textarea name="description" rows="3" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Describe tu experiencia y servicios..."></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Contrase√±a</label>
                        <input type="password" name="password" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" name="terms" required class="mr-2">
                        <label class="text-sm text-gray-700">Acepto los t√©rminos y condiciones</label>
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-colors">
                        Registrarse como Profesional
                    </button>
                </form>
            `);
        };

        // Funci√≥n para mostrar modal de paciente
        window.showPatientModal = function() {
            showModal('Registro de Paciente', `
                <form id="patient-form" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nombre Completo</label>
                            <input type="text" name="name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <input type="email" name="email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Tel√©fono</label>
                            <input type="tel" name="phone" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Edad</label>
                            <input type="number" name="age" min="1" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Direcci√≥n</label>
                        <textarea name="address" rows="2" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="Direcci√≥n completa para servicios a domicilio..."></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Contrase√±a</label>
                        <input type="password" name="password" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" name="terms" required class="mr-2">
                        <label class="text-sm text-gray-700">Acepto los t√©rminos y condiciones</label>
                    </div>
                    <button type="submit" class="w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-colors">
                        Registrarse como Paciente
                    </button>
                </form>
            `);
        };

        // Funci√≥n para mostrar modal gen√©rico
        function showModal(title, content) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="flex justify-between items-center p-6 border-b">
                        <h2 class="text-xl font-bold text-gray-900">${title}</h2>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <div class="p-6">
                        ${content}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            // Event listeners para formularios
            const specialistForm = modal.querySelector('#specialist-form');
            const patientForm = modal.querySelector('#patient-form');

            if (specialistForm) {
                specialistForm.addEventListener('submit', handleSpecialistRegistration);
            }
            if (patientForm) {
                patientForm.addEventListener('submit', handlePatientRegistration);
            }
        }

        // Manejar registro de especialista
        async function handleSpecialistRegistration(e) {
            e.preventDefault();
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Registrando...';
            submitBtn.disabled = true;

            try {
                const formData = new FormData(e.target);
                const data = Object.fromEntries(formData);

                // Validaciones
                if (!data.name || !data.email || !data.phone || !data.specialty || !data.experience || !data.hourlyRate || !data.description || !data.password) {
                    showErrorMessage('Por favor completa todos los campos obligatorios.');
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    return;
                }

                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(data.email)) {
                    showErrorMessage('Por favor ingresa un email v√°lido.');
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    return;
                }

                const experience = parseInt(data.experience);
                if (isNaN(experience) || experience < 0 || experience > 50) {
                    showErrorMessage('Por favor ingresa a√±os de experiencia v√°lidos (0-50 a√±os).');
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    return;
                }

                const hourlyRate = parseInt(data.hourlyRate);
                if (isNaN(hourlyRate) || hourlyRate < 100 || hourlyRate > 5000) {
                    showErrorMessage('Por favor ingresa una tarifa v√°lida (100-5000 MXN por hora).');
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    return;
                }

                // Verificar email duplicado
                if (currentData && currentData.length > 0) {
                    const existingUser = currentData.find(item => 
                        (item.type === 'nurse' || item.type === 'patient') && 
                        item.email.toLowerCase() === data.email.toLowerCase()
                    );

                    if (existingUser) {
                        showErrorMessage('Este email ya est√° registrado. Intenta con otro email.');
                        submitBtn.innerHTML = originalText;
                        submitBtn.disabled = false;
                        return;
                    }
                }

                const nurseData = {
                    type: 'nurse',
                    id: 'nurse_' + Date.now().toString(),
                    name: data.name.trim(),
                    email: data.email.toLowerCase().trim(),
                    phone: data.phone.trim(),
                    specialty: data.specialty,
                    experience: experience,
                    hourlyRate: hourlyRate,
                    description: data.description.trim(),
                    password: data.password,
                    verified: false,
                    rating: 0,
                    reviewCount: 0,
                    registrationDate: new Date().toISOString(),
                    subscription: {
                        plan: 'trial',
                        startDate: new Date().toISOString(),
                        endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(),
                        requestsUsed: 0,
                        requestsLimit: 8
                    }
                };

                console.log('üîÑ Creando profesional:', nurseData);

                const result = await FirebaseService.create(nurseData);
                
                if (result.isOk) {
                    e.target.closest('.fixed').remove();
                    showSuccessMessage('¬°Registro exitoso! Tu cuenta est√° pendiente de verificaci√≥n. Te contactaremos pronto.');
                } else {
                    console.error('‚ùå Error del SDK al crear profesional:', result.error);
                    showErrorMessage('Error en el sistema. Por favor int√©ntalo de nuevo en unos momentos.');
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            } catch (error) {
                console.error('üí• Error cr√≠tico en registro de profesional:', error);
                showErrorMessage('Error inesperado. Por favor recarga la p√°gina e int√©ntalo de nuevo.');
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        }

        // Manejar registro de paciente
        async function handlePatientRegistration(e) {
            e.preventDefault();
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Registrando...';
            submitBtn.disabled = true;

            try {
                const formData = new FormData(e.target);
                const data = Object.fromEntries(formData);

                // Validaciones
                if (!data.name || !data.email || !data.phone || !data.age || !data.address || !data.password) {
                    showErrorMessage('Por favor completa todos los campos obligatorios.');
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    return;
                }

                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(data.email)) {
                    showErrorMessage('Por favor ingresa un email v√°lido.');
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    return;
                }

                const age = parseInt(data.age);
                if (isNaN(age) || age < 1 || age > 120) {
                    showErrorMessage('Por favor ingresa una edad v√°lida (1-120 a√±os).');
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    return;
                }

                // Verificar email duplicado
                if (currentData && currentData.length > 0) {
                    const existingUser = currentData.find(item => 
                        (item.type === 'nurse' || item.type === 'patient') && 
                        item.email.toLowerCase() === data.email.toLowerCase()
                    );

                    if (existingUser) {
                        showErrorMessage('Este email ya est√° registrado. Intenta con otro email.');
                        submitBtn.innerHTML = originalText;
                        submitBtn.disabled = false;
                        return;
                    }
                }

                const patientData = {
                    type: 'patient',
                    id: 'patient_' + Date.now().toString(),
                    name: data.name.trim(),
                    email: data.email.toLowerCase().trim(),
                    phone: data.phone.trim(),
                    age: age,
                    address: data.address.trim(),
                    password: data.password,
                    registrationDate: new Date().toISOString(),
                    subscription: {
                        plan: 'trial',
                        startDate: new Date().toISOString(),
                        endDate: new Date(Date.now() + 15 * 24 * 60 * 60 * 1000).toISOString(),
                        requestsUsed: 0,
                        requestsLimit: 5
                    }
                };

                console.log('üîÑ Creando paciente:', patientData);

                const result = await FirebaseService.create(patientData);
                
                if (result.isOk) {
                    e.target.closest('.fixed').remove();
                    showSuccessMessage('¬°Registro exitoso! Ya puedes buscar profesionales de salud.');
                } else {
                    console.error('‚ùå Error del SDK al crear paciente:', result.error);
                    showErrorMessage('Error en el sistema. Por favor int√©ntalo de nuevo en unos momentos.');
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            } catch (error) {
                console.error('üí• Error cr√≠tico en registro de paciente:', error);
                showErrorMessage('Error inesperado. Por favor recarga la p√°gina e int√©ntalo de nuevo.');
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        }

        // Funciones de mensajes
        function showSuccessMessage(message) {
            showToast(message, 'success');
        }

        function showErrorMessage(message) {
            showToast(message, 'error');
        }

        function showToast(message, type) {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 z-50 p-4 rounded-lg text-white ${type === 'success' ? 'bg-green-600' : 'bg-red-600'}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // Mostrar modal de login
        window.showLoginModal = function() {
            showModal('Iniciar Sesi√≥n', `
                <form id="login-form" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                        <input type="email" name="email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Contrase√±a</label>
                        <input type="password" name="password" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-colors">
                        Iniciar Sesi√≥n
                    </button>
                </form>
                
                <!-- Cuentas de prueba -->
                <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                    <h4 class="font-semibold text-blue-900 mb-3">üß™ Cuentas de Prueba</h4>
                    <div class="space-y-2 text-sm">
                        <div class="bg-white p-3 rounded border">
                            <div class="font-medium text-green-800">üë§ Paciente de Prueba</div>
                            <div class="text-gray-600">Email: <code class="bg-gray-100 px-1 rounded">linkinpark987@hotmail.com</code></div>
                            <div class="text-gray-600">Contrase√±a: <code class="bg-gray-100 px-1 rounded">admin123</code></div>
                            <button onclick="fillLoginForm('linkinpark987@hotmail.com', 'admin123')" 
                                    class="mt-2 text-xs bg-green-600 text-white px-2 py-1 rounded hover:bg-green-700">
                                Usar esta cuenta
                            </button>
                        </div>
                        <div class="bg-white p-3 rounded border">
                            <div class="font-medium text-blue-800">üë©‚Äç‚öïÔ∏è Profesional de Prueba</div>
                            <div class="text-gray-600">Email: <code class="bg-gray-100 px-1 rounded">maria.gonzalez@email.com</code></div>
                            <div class="text-gray-600">Contrase√±a: <code class="bg-gray-100 px-1 rounded">password123</code></div>
                            <button onclick="fillLoginForm('maria.gonzalez@email.com', 'password123')" 
                                    class="mt-2 text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700">
                                Usar esta cuenta
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4 text-center">
                    <p class="text-sm text-gray-600">¬øNo tienes cuenta?</p>
                    <div class="flex space-x-2 mt-2">
                        <button onclick="showSpecialistModal()" class="flex-1 bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700 transition-colors text-sm">
                            Registrarse como Profesional
                        </button>
                        <button onclick="showPatientModal()" class="flex-1 bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700 transition-colors text-sm">
                            Registrarse como Paciente
                        </button>
                    </div>
                </div>
            `);

            document.getElementById('login-form').addEventListener('submit', handleLogin);
        };

        // Manejar login
        async function handleLogin(e) {
            e.preventDefault();
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Iniciando sesi√≥n...';
            submitBtn.disabled = true;

            try {
                const formData = new FormData(e.target);
                const { email, password } = Object.fromEntries(formData);

                console.log('üîê Intentando login:', email);

                // Esperar a que los datos est√©n cargados
                let attempts = 0;
                while (currentData.length === 0 && attempts < 20) {
                    console.log('‚è≥ Esperando datos... intento', attempts + 1);
                    await new Promise(resolve => setTimeout(resolve, 500));
                    attempts++;
                }

                if (currentData.length === 0) {
                    console.log('‚ùå No hay datos despu√©s de esperar');
                    showErrorMessage('Sistema a√∫n cargando. Por favor espera unos segundos e int√©ntalo de nuevo.');
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    return;
                }

                // Buscar usuario
                const allUsers = currentData.filter(item => item.type === 'nurse' || item.type === 'patient');
                console.log('üë• Usuarios disponibles:', allUsers.length);
                
                const user = allUsers.find(item => {
                    const emailMatch = item.email.toLowerCase().trim() === email.toLowerCase().trim();
                    const passwordMatch = item.password === password;
                    return emailMatch && passwordMatch;
                });

                if (user) {
                    console.log('‚úÖ Usuario encontrado:', user.name, user.type);
                    currentUser = user;
                    updateUserInterface();
                    e.target.closest('.fixed').remove();
                    showSuccessMessage(`¬°Bienvenido, ${user.name}!`);
                } else {
                    console.log('‚ùå Credenciales incorrectas');
                    showErrorMessage('Email o contrase√±a incorrectos. Verifica los datos e int√©ntalo de nuevo.');
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
                
            } catch (error) {
                console.error('üí• Error cr√≠tico en login:', error);
                showErrorMessage('Error al iniciar sesi√≥n. Int√©ntalo de nuevo.');
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        }

        // Funci√≥n para llenar formulario de login
        window.fillLoginForm = function(email, password) {
            const emailInput = document.querySelector('input[name="email"]');
            const passwordInput = document.querySelector('input[name="password"]');
            if (emailInput) emailInput.value = email;
            if (passwordInput) passwordInput.value = password;
        };

        // Crear datos de ejemplo
        async function createSampleUsers() {
            try {
                console.log('üìù Verificando datos existentes...');
                
                // Verificar si existe el usuario de prueba
                const testUser = currentData.find(item => 
                    item.email === 'linkinpark987@hotmail.com' && item.type === 'patient'
                );
                
                if (currentData.length > 0 && testUser) {
                    console.log('‚úÖ Ya existen datos completos');
                    return;
                }

                console.log('üîÑ Creando datos de ejemplo...');
                
                // Mostrar indicador
                const container = document.getElementById('nursesList');
                if (container) {
                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <i class="fas fa-database text-4xl text-green-600 mb-4"></i>
                            <h3 class="text-lg font-semibold text-gray-600 mb-2">Creando datos de ejemplo...</h3>
                            <p class="text-gray-500">Configurando profesionales y pacientes</p>
                        </div>
                    `;
                }

                // Crear usuario de prueba principal
                const testPatient = {
                    type: 'patient',
                    id: 'patient_admin_test',
                    name: 'Paciente de Prueba',
                    email: 'linkinpark987@hotmail.com',
                    phone: '999-000-0000',
                    age: 35,
                    address: 'Direcci√≥n de Prueba Admin, M√©rida, Yucat√°n',
                    password: 'admin123',
                    registrationDate: new Date().toISOString(),
                    subscription: {
                        plan: 'premium',
                        startDate: new Date().toISOString(),
                        endDate: new Date(Date.now() + 365 * 24 * 60 * 60 * 1000).toISOString(),
                        requestsUsed: 8,
                        requestsLimit: 15
                    }
                };

                // Crear profesional de prueba
                const testNurse = {
                    type: 'nurse',
                    id: 'nurse_test_001',
                    name: 'Dra. Mar√≠a Gonz√°lez',
                    email: 'maria.gonzalez@email.com',
                    phone: '999-123-4567',
                    specialty: 'medicina_general',
                    experience: 8,
                    hourlyRate: 800,
                    description: 'M√©dica general especializada en consultas domiciliarias y medicina preventiva. M√°s de 8 a√±os de experiencia en hospitales privados de M√©rida.',
                    password: 'password123',
                    verified: true,
                    rating: 4.8,
                    reviewCount: 24,
                    registrationDate: new Date(Date.now() - 180 * 24 * 60 * 60 * 1000).toISOString(),
                    subscription: {
                        plan: 'premium',
                        startDate: new Date(Date.now() - 15 * 24 * 60 * 60 * 1000).toISOString(),
                        endDate: new Date(Date.now() + 15 * 24 * 60 * 60 * 1000).toISOString(),
                        requestsUsed: 12,
                        requestsLimit: 25
                    }
                };

                // Crear los usuarios de prueba
                const sampleData = [testPatient, testNurse];
                
                for (const item of sampleData) {
                    const result = await FirebaseService.create(item);
                    if (result.isOk) {
                        console.log('‚úÖ Creado:', item.name);
                    } else {
                        console.log('‚ùå Error creando:', item.name, result.error);
                    }
                }

                console.log('üéâ Datos de ejemplo creados exitosamente');
                
                // Actualizar UI
                setTimeout(() => {
                    updateUI();
                }, 1500);
                
            } catch (error) {
                console.error('üí• Error creando datos de ejemplo:', error);
                const container = document.getElementById('nursesList');
                if (container) {
                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <i class="fas fa-exclamation-triangle text-4xl text-red-500 mb-4"></i>
                            <h3 class="text-lg font-semibold text-red-600 mb-2">Error al crear datos</h3>
                            <p class="text-gray-500 mb-4">No se pudieron crear los datos de ejemplo</p>
                            <button onclick="location.reload()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                                Recargar P√°gina
                            </button>
                        </div>
                    `;
                }
            }
        }

        // Funciones placeholder para evitar errores
        function updateNursesList() {
            console.log('üìã Actualizando lista de profesionales...');
        }

        function updateAdminStats() {
            console.log('üìä Actualizando estad√≠sticas admin...');
        }

        function updatePendingVerifications() {
            console.log('‚è≥ Actualizando verificaciones pendientes...');
        }

        function updateRegisteredUsers() {
            console.log('üë• Actualizando usuarios registrados...');
        }

        function updateSubscriptionManagement() {
            console.log('üí≥ Actualizando gesti√≥n de suscripciones...');
        }

        function updatePatientDashboard() {
            console.log('üè• Actualizando dashboard del paciente...');
        }

        function updateProfessionalDashboard() {
            console.log('üë©‚Äç‚öïÔ∏è Actualizando dashboard del profesional...');
        }

        // Event listeners b√°sicos
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ DOM cargado, inicializando aplicaci√≥n...');
            
            // Inicializar aplicaci√≥n
            initializeApp();

            // Botones de autenticaci√≥n
            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const adminBtn = document.getElementById('admin-btn');

            if (loginBtn) {
                loginBtn.addEventListener('click', showLoginModal);
            }

            if (logoutBtn) {
                logoutBtn.addEventListener('click', function() {
                    currentUser = null;
                    updateUserInterface();
                    showSuccessMessage('Sesi√≥n cerrada exitosamente.');
                });
            }

            if (adminBtn) {
                adminBtn.addEventListener('click', function() {
                    showModal('Acceso de Administrador', `
                        <form id="admin-login-form" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Email de Administrador</label>
                                <input type="email" name="email" required value="linkinpark98772@gmail.com" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Contrase√±a</label>
                                <input type="password" name="password" required value="Gears1204" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500">
                            </div>
                            <button type="submit" class="w-full bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition-colors">
                                <i class="fas fa-user-shield mr-2"></i>Acceder como Administrador
                            </button>
                        </form>
                    `);

                    document.getElementById('admin-login-form').addEventListener('submit', function(e) {
                        e.preventDefault();
                        const formData = new FormData(e.target);
                        const { email, password } = Object.fromEntries(formData);

                        if (email === 'linkinpark98772@gmail.com' && password === 'Gears1204') {
                            const mainContent = document.getElementById('mainContent');
                            const adminPanel = document.getElementById('adminPanel');
                            if (mainContent) mainContent.classList.add('hidden');
                            if (adminPanel) adminPanel.classList.remove('hidden');
                            e.target.closest('.fixed').remove();
                            showSuccessMessage('Acceso de administrador concedido.');
                        } else {
                            showErrorMessage('Credenciales de administrador incorrectas.');
                        }
                    });
                });
            }

            console.log('‚úÖ Event listeners configurados');
        });

        // Funci√≥n para mostrar detalles de planes
        window.showPlanDetails = function(userType, planKey) {
            const plan = subscriptionPlans[userType][planKey];
            showModal(`Detalles del ${plan.name}`, `
                <div class="space-y-6">
                    <div class="bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg p-6 text-white text-center">
                        <h3 class="text-2xl font-bold">${plan.name}</h3>
                        <div class="text-4xl font-bold mb-2">
                            $${plan.price}
                            ${plan.price > 0 ? '<span class="text-lg font-normal opacity-75">/mes</span>' : ''}
                        </div>
                        <p class="opacity-90">${plan.duration} d√≠as de duraci√≥n</p>
                    </div>

                    <div>
                        <h4 class="font-semibold text-gray-900 mb-4">Todo lo que Incluye</h4>
                        <div class="space-y-3">
                            ${plan.features.map(feature => `
                                <div class="flex items-start">
                                    <i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i>
                                    <span class="text-gray-700">${feature}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="flex space-x-3">
                        <button onclick="document.querySelector('.fixed').remove()" 
                                class="flex-1 bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors font-semibold">
                            Entendido
                        </button>
                    </div>
                </div>
            `);
        };

        // Limpiar al cerrar la p√°gina
        window.addEventListener('beforeunload', function() {
            if (FirebaseService) {
                FirebaseService.cleanup();
            }
        });

        console.log('üéØ C√≥digo Firebase cargado completamente');
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99f4bc2b64ff8483',t:'MTc2MzI3MjQ4MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
